Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	vqsr_filter
	1

[Tue Nov 30 18:55:56 2021]
rule vqsr_filter:
    input: process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr.vcf.gz
    output: process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr_snps.vcf.gz, process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.vcf.gz
    log: process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.log
    jobid: 0
    wildcards: samp=10561-Room_S8, mapper=bwa, ref=H37Rv

18:56:05.359 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/home/kwalter/.conda/envs/snakemake/share/gatk4-4.1.4.1-1/gatk-package-4.1.4.1-local.jar!/com/intel/gkl/native/libgkl_compression.so
Nov 30, 2021 6:56:06 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine
INFO: Failed to detect whether we are running on Google Compute Engine.
18:56:06.674 INFO  SelectVariants - ------------------------------------------------------------
18:56:06.675 INFO  SelectVariants - The Genome Analysis Toolkit (GATK) v4.1.4.1
18:56:06.675 INFO  SelectVariants - For support and documentation go to https://software.broadinstitute.org/gatk/
18:56:06.679 INFO  SelectVariants - Executing as kwalter@dper7425-srcf-d15-31.scg.stanford.edu on Linux v3.10.0-1160.45.1.el7.x86_64 amd64
18:56:06.679 INFO  SelectVariants - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_112-b16
18:56:06.680 INFO  SelectVariants - Start Date/Time: November 30, 2021 6:56:05 PM PST
18:56:06.680 INFO  SelectVariants - ------------------------------------------------------------
18:56:06.680 INFO  SelectVariants - ------------------------------------------------------------
18:56:06.680 INFO  SelectVariants - HTSJDK Version: 2.21.0
18:56:06.680 INFO  SelectVariants - Picard Version: 2.21.2
18:56:06.680 INFO  SelectVariants - HTSJDK Defaults.COMPRESSION_LEVEL : 2
18:56:06.680 INFO  SelectVariants - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : false
18:56:06.680 INFO  SelectVariants - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : true
18:56:06.680 INFO  SelectVariants - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : false
18:56:06.681 INFO  SelectVariants - Deflater: IntelDeflater
18:56:06.681 INFO  SelectVariants - Inflater: IntelInflater
18:56:06.681 INFO  SelectVariants - GCS max retries/reopens: 20
18:56:06.681 INFO  SelectVariants - Requester pays: disabled
18:56:06.681 INFO  SelectVariants - Initializing engine
18:56:07.268 INFO  FeatureManager - Using codec VCFCodec to read file file:///oak/stanford/scg/lab_jandr/walter/tb/capture/process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr.vcf.gz
18:56:07.303 INFO  SelectVariants - Done initializing engine
18:56:07.403 INFO  ProgressMeter - Starting traversal
18:56:07.406 INFO  ProgressMeter -        Current Locus  Elapsed Minutes    Variants Processed  Variants/Minute
18:56:17.407 INFO  ProgressMeter -  NC_000962.3:1198278              0.2               1198000        7188000.0
18:56:27.417 INFO  ProgressMeter -  NC_000962.3:3989464              0.3               3989000       11961617.3
18:56:29.261 INFO  ProgressMeter -  NC_000962.3:4411476              0.4               4411056       12109968.4
18:56:29.261 INFO  ProgressMeter - Traversal complete. Processed 4411056 total variants in 0.4 minutes.
18:56:29.288 INFO  SelectVariants - Shutting down engine
[November 30, 2021 6:56:29 PM PST] org.broadinstitute.hellbender.tools.walkers.variantutils.SelectVariants done. Elapsed time: 0.40 minutes.
Runtime.totalMemory()=2975334400
Using GATK jar /home/kwalter/.conda/envs/snakemake/share/gatk4-4.1.4.1-1/gatk-package-4.1.4.1-local.jar
Running:
    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -jar /home/kwalter/.conda/envs/snakemake/share/gatk4-4.1.4.1-1/gatk-package-4.1.4.1-local.jar SelectVariants -V process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr.vcf.gz --select-type-to-exclude INDEL -O process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr_snps.vcf.gz
The filter "VQSRTrancheSNP99.00to100.00" not present in the VCF header
[Tue Nov 30 18:56:29 2021]
Error in rule vqsr_filter:
    jobid: 0
    output: process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr_snps.vcf.gz, process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.vcf.gz
    log: process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.log (check log file(s) for error message)
    shell:
        
    # Select SNPs
    gatk SelectVariants     -V process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr.vcf.gz     --select-type-to-exclude INDEL     -O process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr_snps.vcf.gz 
    
    # Filter VQSR
    bcftools filter -e 'FILTER == "VQSRTrancheSNP99.00to100.00" ' --set-GTs '.' process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr_snps.vcf.gz -O z -o process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.vcf.gz

    # Index filtered VCF.
    tabix -f -p vcf process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.vcf.gz

    # Print out stats to log file. 
    bcftools stats process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.vcf.gz &>> process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.log
    
    
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job vqsr_filter since they might be corrupted:
process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsr_snps.vcf.gz, process/vars/10561-Room_S8_bwa_H37Rv_gatk_vqsrfilt.vcf.gz
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
runs are:  ['MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT01_MtB_Baits-2021-10-06rerun2', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT02_MTB_2021-10-29', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-09-17', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2', 'MT01_MtB_Baits-2021-10-01rerun2']
samples are:  ['7033_S18', '8328-BC_S9', '5346_S12', '4514-lighter-384_S5', '8020-sputum_S11', '22-1545_S21', '10561-Room_S8', '7067_S20', '10561-BC_S6', '6470_S16', '4514-food_S4', 'H37RV_S1', '5797_S14', 'SHTBRm2_S3', '5720_S13', '34-5748_S23', '35-6968_S24', 'SHTBRm1_S2', '23-5747_S22', '8328-Food_S10', '10561-Food_S7', '6150_S15', '7027_S17', '7056_S19', 'L5793_S5', 'L5010_S17', '6752_S25', 'L5005_S22', 'L4187_S14', '6547_S27', '7078_S3', '14-346661_S19', '3956_S31', '5014_S23', 'L5639_S9', 'L5977_S10', 'L4404_S4', 'L5938_S12', '611_S29', 'L3947_S15', 'L4378_S18', 'L5011_S16', '6472_S26', 'L5928_S7', '7162_S32', '6091_S30', 'L5693_S11', 'L4104_S21', '6934_S2', '7432_S28', 'L55555_S8', '1734_S20', 'L4426_S13', '1250_S24', 'L5853_S6', '7021_S1', '7033_S18', '8328-BC_S9', '5346_S12', '4514-lighter-384_S5', '8020-sputum_S11', '22-1545_S21', '7067_S20', '6470_S16', '4514-food_S4', 'H37RV_S1', '5797_S14', '5720_S13', '34-5748_S23', '35-6968_S24', '23-5747_S22', '8328-Food_S10', '10561-Food_S7', 'TBIRm1_S2', '6150_S15', '7027_S17', '7056_S19', 'TBIRm2_S3', '7033_S18', '8328-BC_S9', '5346_S12', '4514-lighter-384_S5', '8020-sputum_S11', '22-1545_S21', '10561-Room_S8', '7067_S20', '10561-BC_S6', '6470_S16', '4514-food_S4', 'H37RV_S1', '5797_S14', 'SHTBRm2_S3', '5720_S13', '34-5748_S23', '35-6968_S24', 'SHTBRm1_S2', '23-5747_S22', '8328-Food_S10', '10561-Food_S7', '6150_S15', '7027_S17', '7056_S19']
